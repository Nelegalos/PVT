package by.pvt.resource.pool;

import by.pvt.resource.exception.OperatorTechnicalException;
import static by.pvt.resource.main.Runner.logger;

public class Client extends Thread {

	private boolean talking = false;
	private CallCenter<T> callCenter;

	public Client(CallCenter<T> callCenter) {
		this.callCenter = callCenter;
	}

	public void run() {
		T operator = null;
		try {
			operator = callCenter.getOperator(5000);			
			talking = true;
			System.out.println("Client #" + this.getId()
					+ " is talking to operator #" + operator.getOperatorId());
			operator.talking();
		} catch (OperatorTechnicalException e1) {
			logger.info("Client #" + this.getId() + " hung up", e1);

		} finally {
			if (operator != null) {
				talking = false;
				System.out.println("Client #" + this.getId()
						+ " released operator #" + operator.getOperatorId());
				callCenter.releaseOperator(operator);
			}
		}
	}

	public boolean isTalking() {
		return talking;
	}
}
